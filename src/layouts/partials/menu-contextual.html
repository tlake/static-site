{{/*
  Use Hugo's native Table of contents feature. You must set `toc: true` in your parameters for this to show.
  https://gohugo.io/content-management/toc/
*/}}

{{/* TL CUSTOM: Add debug info. */}}
{{- if eq (getenv "HUGO_ENV") "debug" | or (eq .Site.Params.env "debug") }}
<ul>
  <li>rendered: partials/menu-contextual.html</li>
</ul>
{{- end }}
{{/* TL CUSTOM: END */}}

{{- if .Params.toc -}}
  {{/* TL CUSTOM:
    - Add toc_classes.
    - Remove nested-list-reset class.
  END */}}
  <div class="{{ $.Param "toc_classes" | default "avenir bg-near-white" }} pa3 nested-copy-line-height nested-links">
    <p class="f5 b mb3">{{ i18n "whatsInThis" . }}</p>
    {{ .TableOfContents }}
    </div>
{{- end -}}

{{/*
  Use Hugo's native related content feature to pull in content that may have similar parameters, like tags. etc.
  https://gohugo.io/content-management/related/
*/}}

{{ $related := .Site.RegularPages.Related . | first 15 }}

{{ with $related }}
  {{/* TL CUSTOM: Add toc_classes. END */}}
  <div class="{{ $.Param "toc_classes" | default "bg-light-gray" }} pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">{{ i18n "related" }}</p>
    <ul class="pa0 list">
      {{ range . }}
        <li  class="mb2">
          <a href="{{ .RelPermalink }}">
            {{- .Title -}}
          </a>
        </li>
      {{ end }}
    </ul>
</div>
{{ end }}
