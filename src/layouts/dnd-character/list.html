{{ define "header" }}
{{/* We can override any block in the baseof file be defining it in the template */}}
{{ partial "page-header.html" . }}
{{ end }}

{{ define "main" }}
{{ $section := .Site.GetPage "section" .Section }}

{{- if eq (getenv "HUGO_ENV") "debug" | or (eq .Site.Params.env "debug") }}
<ul>
  <li>layout: dnd-character/one-off.html</li>
</ul>
{{- end }}

<article class="cf pa3 pa4-m pa4-l">
  <header class="measure-wide-l center f4 lh-copy">

    <aside class="instapaper_ignoref b helvetica tracked">
      {{/*
      CurrentSection allows us to use the section title instead of inferring from the folder.
      https://gohugo.io/variables/page/#section-variables-and-methods
      */}}
      {{with .CurrentSection.Title }}{{. | upper }}{{end}}
    </aside>

    {{ partial "social-share.html" . }}

    {{ if .Description }}
    <p>{{ .Description }}</p>
    {{ end }}

    {{ with .Params.author }}
    <p class="tracked">
      By <strong>
        {{ if reflect.IsSlice . }}
        {{ delimit . ", " | markdownify }}
        {{else}}
        {{ . | markdownify }}
        {{ end }}
      </strong>
    </p>
    {{ end }}

  </header>

  <div class="measure-wide-l center f4 nested-copy-line-height lh-copy nested-links {{ $.Param " post_content_classes" |
    default "serif" }} f4 nested-links nested-img {{ $.Param "primary_font_color_class" | default "mid-gray" }} pr4-l">
    {{- .Content -}}
    {{- partial "tags.html" . -}}
  </div>

  <div class="measure-wide-l center f4 nested-copy-line-height lh-copy">
    <div class="mt6 instapaper_ignoref">
      {{ if .Site.DisqusShortname }}
      {{ template "_internal/disqus.html" . }}
      {{ end }}
      {{ if .Site.Params.commentoEnable }}
      {{- partial "commento.html" . -}}
      {{ end }}
    </div>

    <aside class="w-30-l mt6-l">
      {{- partial "menu-contextual.html" . -}}
    </aside>
  </div>

</article>

{{ end }}
